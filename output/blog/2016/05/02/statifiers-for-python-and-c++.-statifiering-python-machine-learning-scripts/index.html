<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Statifiers for Python and C++. Statifiering python Machine-Learning scripts - Programmatic Statistics</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://igormarfin.github.io/blog/2016/05/02/statifiers-for-python-and-c++.-statifiering-python-machine-learning-scripts/">

        <meta name="author" content="Dr. Igor Marfin" />
        <meta name="keywords" content="statifier,GO,XGO,Pyinstaller,CGO,Cython,Python,C++" />
        <meta name="description" content="Statifiers for Python and C++. Statifiering python Machine-Learning scripts Author:Igor Marfin Contact:igor.marfin@unister.de Organization:private Date:Apr 26, 2016, 9:06:51 AM Status:draft Version:1 Copyright:This document has been placed in the public domain. You may do with it as you wish. You ..." />

        <meta property="og:site_name" content="Programmatic Statistics" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Statifiers for Python and C++. Statifiering python Machine-Learning scripts"/>
        <meta property="og:url" content="http://igormarfin.github.io/blog/2016/05/02/statifiers-for-python-and-c++.-statifiering-python-machine-learning-scripts/"/>
        <meta property="og:description" content="Statifiers for Python and C++. Statifiering python Machine-Learning scripts Author:Igor Marfin Contact:igor.marfin@unister.de Organization:private Date:Apr 26, 2016, 9:06:51 AM Status:draft Version:1 Copyright:This document has been placed in the public domain. You may do with it as you wish. You ..."/>
        <meta property="article:published_time" content="2016-05-02" />
            <meta property="article:section" content="Programming" />
            <meta property="article:tag" content="statifier" />
            <meta property="article:tag" content="GO" />
            <meta property="article:tag" content="XGO" />
            <meta property="article:tag" content="Pyinstaller" />
            <meta property="article:tag" content="CGO" />
            <meta property="article:tag" content="Cython" />
            <meta property="article:tag" content="Python" />
            <meta property="article:tag" content="C++" />
            <meta property="article:author" content="Dr. Igor Marfin" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://igormarfin.github.io/theme/css/bootstrap.yeti.min.css" type="text/css"/>
    <link href="http://igormarfin.github.io/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://igormarfin.github.io/theme/css/pygments/autumn.css" rel="stylesheet">
    <link href="http://igormarfin.github.io/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="http://igormarfin.github.io/theme/css/style.css" type="text/css"/>

        <link href="http://igormarfin.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Programmatic Statistics ATOM Feed"/>



        <link href="http://igormarfin.github.io/feeds/programming.atom.xml" type="application/atom+xml" rel="alternate"
              title="Programmatic Statistics Programming ATOM Feed"/>
    
<!-- MathJax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>

</head>
<body>
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
	    <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="http://igormarfin.github.io/" class="navbar-brand">
Programmatic Statistics                </a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                            <li >
                                <a href="http://igormarfin.github.io/category/about-me.html">About me</a>
                            </li>
                            <li >
                                <a href="http://igormarfin.github.io/category/buildingthisblog.html">Buildingthisblog</a>
                            </li>
                            <li class="active">
                                <a href="http://igormarfin.github.io/category/programming.html">Programming</a>
                            </li>
                            <li >
                                <a href="http://igormarfin.github.io/category/statistics.html">Statistics</a>
                            </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                  <li><span>
                    <form class="navbar-search" action="/search.html">
                      <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                    </form></span>
                  </li>
                  <li><a href="http://igormarfin.github.io/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
    </div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://igormarfin.github.io/blog/2016/05/02/statifiers-for-python-and-c++.-statifiering-python-machine-learning-scripts/"
                       rel="bookmark"
                       title="Permalink to Statifiers for Python and C++. Statifiering python Machine-Learning scripts">
                        Statifiers for Python and C++. Statifiering python Machine-Learning scripts
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2016-05-02T20:32:00+02:00"> Mon 02 May 2016</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="http://igormarfin.github.io/tag/statifier.html">statifier</a>
        /
	<a href="http://igormarfin.github.io/tag/go.html">GO</a>
        /
	<a href="http://igormarfin.github.io/tag/xgo.html">XGO</a>
        /
	<a href="http://igormarfin.github.io/tag/pyinstaller.html">Pyinstaller</a>
        /
	<a href="http://igormarfin.github.io/tag/cgo.html">CGO</a>
        /
	<a href="http://igormarfin.github.io/tag/cython.html">Cython</a>
        /
	<a href="http://igormarfin.github.io/tag/python.html">Python</a>
        /
	<a href="http://igormarfin.github.io/tag/c.html">C++</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <div class="section" id="id1">
<h2><a class="toc-backref" href="#id85">Statifiers for Python and C++. Statifiering python Machine-Learning scripts</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Igor Marfin</td>
</tr>
<tr class="field"><th class="field-name">Contact:</th><td class="field-body"><a class="reference external" href="mailto:igor.marfin&#64;unister.de">igor.marfin&#64;unister.de</a></td>
</tr>
<tr class="field"><th class="field-name">Organization:</th><td class="field-body">private</td>
</tr>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">Apr 26, 2016, 9:06:51 AM</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">draft</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">1</td>
</tr>
<tr class="field"><th class="field-name">Copyright:</th><td class="field-body">This document has been placed in the public domain. You
may do with it as you wish. You may copy, modify,
redistribute, reattribute, sell, buy, rent, lease,
destroy, or improve it, quote it at length, excerpt,
incorporate, collate, fold, staple, or mutilate it, or do
anything else to it that your or anyone else's heart
desires.</td>
</tr>
</tbody>
</table>
<div class="admonition-dedication admonition">
<p class="first admonition-title">Dedication</p>
<p class="last">For statisticians &amp; programmers</p>
</div>
<div class="admonition-abstract admonition">
<p class="first admonition-title">Abstract</p>
<p class="last">This projects reveals a few secrets about the ways how to produce cross-platform programs in Python and C++.</p>
</div>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#id1" id="id85">Statifiers for Python and C++. Statifiering python Machine-Learning scripts</a><ul>
<li><a class="reference internal" href="#introduction-to-the-topic-and-motivation" id="id86">Introduction to the topic and motivation</a></li>
<li><a class="reference internal" href="#protecting-a-python-codebase" id="id87">Protecting a Python codebase</a></li>
<li><a class="reference internal" href="#installation-of-the-tutorial" id="id88">Installation of the tutorial</a></li>
<li><a class="reference internal" href="#go-a-swiss-army-knife-for-cross-platform-applications" id="id89">Go: a swiss army knife for cross-platform applications</a></li>
<li><a class="reference internal" href="#how-to-create-a-binary-from-a-python-script-with-pyinstaller" id="id90">How to create a binary from a Python Script with <tt class="docutils literal">PyInstaller</tt></a></li>
<li><a class="reference internal" href="#how-to-compile-python-scripts-with-cython" id="id91">How to compile python scripts with <tt class="docutils literal">Cython</tt></a></li>
<li><a class="reference internal" href="#cgo-go-binding-for-c-c" id="id92">CGO: GO Binding for C/C++</a><ul>
<li><a class="reference internal" href="#xgo-cgo-cross-compiler" id="id93">XGO - CGO cross compiler</a></li>
</ul>
</li>
<li><a class="reference internal" href="#connecting-go-and-python-together" id="id94">Connecting GO and Python together</a><ul>
<li><a class="reference internal" href="#binding-cgo-and-cython-together" id="id95">Binding CGO and Cython together</a></li>
</ul>
</li>
<li><a class="reference internal" href="#python-virtual-machine" id="id96">Python Virtual Machine</a></li>
<li><a class="reference internal" href="#static-python" id="id97">Static-Python</a></li>
<li><a class="reference internal" href="#bonus-a-simple-statifier-to-make-a-portable-executable-package-from-any-binary" id="id98">Bonus: A simple statifier to make a portable executable package from any binary</a></li>
<li><a class="reference internal" href="#documentation" id="id99">Documentation</a></li>
<li><a class="reference internal" href="#references" id="id100">References</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction-to-the-topic-and-motivation">
<h3><a class="toc-backref" href="#id86">Introduction to the topic and motivation</a></h3>
<p>I want to introduce you to my motivation which forces me to develop this project.</p>
<p>You may be wondering, &quot;why would you want to have statically linked python applications?&quot;.
There are a few reasons why dynamic linking for Python and C/
C++ programs is superior :</p>
<ul class="simple">
<li>Fixes (either security or only bug) have to be applied to only one place: the new DSO(s).
If various applications are linked statically, all of them would have to be relinked.
By the time the problem is discovered the sysadmin usually forgot which apps are built with the problematic library.</li>
<li>Security measures like load address randomization cannot be used.
With statically linked applications, only the stack and heap address can be randomized.
All text has a fixed address in all invocations.
With dynamically linked applications, the kernel has the ability to load all DSOs at arbitrary addresses,
independent from each other.
In case the application is built as a position independent executable (PIE) even this code can be
loaded at random addresses.
Fixed addresses (or even only fixed offsets) are the dreams of attackers.
And no, it is not possible in general to generate PIEs with static linking.</li>
<li>More efficient use of physical memory. All processes share the same physical pages for the code in the DSOs.
With prelinking startup times for dynamically linked code is as good as that of statically linked code.</li>
<li>All kinds of features in the libc (locale (through iconv), NSS, IDN, ...)
require dynamic linking to load the appropriate external code.
We have very limited support for doing this in statically linked code.
But it requires that the dynamically loaded modules available at runtime must come from the same glibc
version as the code linked into the application.
And it is completely unsupported to dynamically load DSOs this way which are not part of glibc.</li>
<li>Related, trivial NSS modules can be used from statically linked apps directly.
If they require extensive dependencies (like the LDAP NSS module, not part of glibc proper)
this will likely not work.</li>
<li>No accidental violation of the (L)GPL. Should a program which is statically linked be given to a third party,
it is necessary to provide the possibility to regenerate the program code.</li>
<li>Tools and hacks like ltrace, LD_PRELOAD, LD_PROFILE, LD_AUDIT don't work at the statical linking.
These can be effective debugging and profiling, especially for remote debugging where
the user cannot be trusted with doing complex debugging work.</li>
</ul>
<p>After all, &quot;static linking is evil&quot;.  But, how would we answer questions, pointed out below,
if the dynamic linking were only possible at the modern Operating Systems:</p>
<ul class="simple">
<li>Were it possible to achieve cross platform compatibility in C/C++ applications?</li>
<li>Were it possible to run Python programs on other machines without requiring that they have installed Python?</li>
<li>Were it possible to run Python programs on other machines without requiring that they have had
the same versions of the same libraries installed that you do?</li>
<li>Were it possible to distribute the python code under the commercial licence? The <tt class="docutils literal">.pyc</tt> files
can be easily decompiled (disassembled) and  the code, that checks the license file, can be removed.
It is not desirable that the commercial code could be read by customers,
because the code might be stolen or at least the &quot;novel ideas&quot;. Also for
proprietary or security-conscious applications, this is unacceptable.</li>
</ul>
<style> .red {color:red; font-size: 200%;} </style><p>It would be &quot;<span class="red">NOT</span>, <span class="red">NOT</span> and once more <span class="red">NOT</span>&quot; possible.</p>
<p>In this tutorial, I will try to review technologies helping to build cross-platform (cross-compiled)
solutions in Python and C/C++. My <a class="reference external" href="https://bitbucket.org/iggy_floyd/virtual_machine_python">project</a> <a class="footnote-reference" href="#id30" id="id31">[1]</a>, which I call a <tt class="docutils literal">Python Virtual Machine</tt>, is aimed to
illustrate considered approaches and techniques.</p>
<div class="figure align-center">
<img alt="Cross-platform compatibility" src="/images/Crossplatform.jpg" style="width: 770.0px; height: 320.0px;" />
<p class="caption">Cross-platform applications</p>
</div>
</div>
<div class="section" id="protecting-a-python-codebase">
<h3><a class="toc-backref" href="#id87">Protecting a Python codebase</a></h3>
<p>There are numerous discussions and arguments about protection of the python codebase with
exploting the bytecode <a class="reference external" href="http://bits.citrusbyte.com/protecting-a-python-codebase/">ref1</a> <a class="footnote-reference" href="#id32" id="id33">[2]</a>, <a class="reference external" href="https://github.com/citrusbyte/python-obfuscation">ref2</a> <a class="footnote-reference" href="#id34" id="id35">[3]</a>, <a class="reference external" href="http://stackoverflow.com/questions/261638/how-do-i-protect-python-code">ref3</a> <a class="footnote-reference" href="#id36" id="id37">[4]</a>.</p>
<p>The generated <tt class="docutils literal">*.pyc</tt> files are quite simple binaries containing <tt class="docutils literal">a magic number (four bytes)</tt>,
<tt class="docutils literal">a timestamp (four bytes)</tt>, <tt class="docutils literal">a code object (marshalled code)</tt>.
It’s fair to think that this is a secure mechanism.
It’s not hard to apply the <tt class="docutils literal">dis</tt> module to get a notion of what the code is about,
and there are tools which can be used to translate the op-codes back to human-friendly strings, for example
that’s already done by the <tt class="docutils literal">uncompyle2 package</tt>.</p>
<p>Usually at forums, when someone raises a request on help, like</p>
<pre class="doctest-block">
&gt;&gt;&gt; I'm building a Python application and don't want to force my clients to install Python and modules. I also want to make my application closed-source.
</pre>
<p>three solutions are proposed:</p>
<ul class="simple">
<li><a class="reference external" href="https://mborgerson.com/creating-an-executable-from-a-python-script">pyinstaller</a> <a class="footnote-reference" href="#id38" id="id39">[5]</a></li>
<li><a class="reference external" href="http://nuitka.net/doc/user-manual.html#command-line">nuitka</a> <a class="footnote-reference" href="#id40" id="id41">[6]</a></li>
<li><a class="reference external" href="https://pypi.python.org/pypi/Cython/">cython</a> <a class="footnote-reference" href="#id42" id="id43">[7]</a></li>
</ul>
<p>I have tested all of them.
Unfortunately I have to admit that <tt class="docutils literal">nuitka</tt> has failed to produce C++ wrapping code from python scripts.
Therefore I restrict myself to consideration of <tt class="docutils literal">pyinstaller</tt>'s  and <tt class="docutils literal">cython</tt>'s ways to <tt class="docutils literal">binarize</tt> python code.
Before we proceed further, I spend some time on installation instructions.</p>
</div>
<div class="section" id="installation-of-the-tutorial">
<h3><a class="toc-backref" href="#id88">Installation of the tutorial</a></h3>
<div class="important">
<p class="first admonition-title">Important</p>
<p class="last">The project relies on the presence of <tt class="docutils literal">Autotools</tt> in the system.
Before, proceed further, please, install them: <tt class="docutils literal">sudo <span class="pre">apt-get</span> install <span class="pre">autotools-dev</span></tt>.</p>
</div>
<p>Simply, clone the project</p>
<div class="highlight"><pre>git clone https://iggy_floyd@bitbucket.org/iggy_floyd/virtual_machine_python.git
</pre></div>
<p>and test a configuration of your system that you have components like</p>
<ul class="simple">
<li>python</li>
<li>scientific python modules</li>
<li>golang and its supporting tools</li>
</ul>
<p>installed. It is done via the <tt class="docutils literal">make</tt>  command as it's  shown below</p>
<div class="highlight"><pre>make
</pre></div>
</div>
<div class="section" id="go-a-swiss-army-knife-for-cross-platform-applications">
<h3><a class="toc-backref" href="#id89">Go: a swiss army knife for cross-platform applications</a></h3>
<p>A few years ago I tinkered with Go, a language created and promoted by google. I found it cool. I have developed a few small projects, <a class="reference external" href="https://bitbucket.org/iggy_floyd/go-cpp">go-cpp</a> <a class="footnote-reference" href="#id44" id="id45">[8]</a>,
<a class="reference external" href="https://bitbucket.org/iggy_floyd/go-tutorial">go-tutorials</a> <a class="footnote-reference" href="#id46" id="id47">[9]</a> and <a class="reference external" href="https://bitbucket.org/iggy_floyd/test-otto">test-otto (a Go's javascript interpeter)</a> <a class="footnote-reference" href="#id48" id="id49">[10]</a> in Go.</p>
<p>There is a number of reasons that folks are in love with golang. One the most mentioned is the static linking.</p>
<p>As long as the source being compiled is native go, the go compiler will statically link the executable.
Though when you need to use cgo, then the compiler has to use its external linker.</p>
<div class="important">
<p class="first admonition-title">Important</p>
<p>At least Go compiler and linker are needed to be installed in the system. Please, read and follow installation instructions found at
the official <a class="reference external" href="https://golang.org/doc/install">web site</a> <a class="footnote-reference" href="#id50" id="id51">[11]</a> of the Golang.  Also it would be helpful to install the <tt class="docutils literal">godocdown</tt> <a class="reference external" href="https://github.com/robertkrimen/godocdown">tool</a> <a class="footnote-reference" href="#id52" id="id53">[12]</a> generating Go documentation in the
Markdown format:</p>
<div class="last"><div class="highlight"><pre>go get github.com/robertkrimen/godocdown/godocdown
</pre></div>
</div></div>
</div>
<div class="section" id="how-to-create-a-binary-from-a-python-script-with-pyinstaller">
<h3><a class="toc-backref" href="#id90">How to create a binary from a Python Script with <tt class="docutils literal">PyInstaller</tt></a></h3>
<div class="important">
<p class="first admonition-title">Important</p>
<p>I would like to mention that all experiments with statifiers have been done in the 32-bit <tt class="docutils literal">wheezy</tt>-Debian VM.</p>
<div class="highlight"><pre>lsb_release -a<span class="p">;</span> uname -a
</pre></div>
<pre class="last doctest-block">
&gt;&gt;&gt; Distributor ID: Debian
&gt;&gt;&gt; Description:    Debian GNU/Linux 7.8 (wheezy)
&gt;&gt;&gt; Release:        7.8
&gt;&gt;&gt; Codename:       wheezy
&gt;&gt;&gt; Linux debian 3.2.0-4-686-pae #1 SMP Debian 3.2.65-1+deb7u2 i686 GNU/Linux
</pre>
</div>
<p>In our first exercise we experiment with the <tt class="docutils literal">Pyinstaller</tt>.  There is a <a class="reference external" href="https://mborgerson.com/creating-an-executable-from-a-python-script">nice post</a> <a class="footnote-reference" href="#id38" id="id54">[5]</a> from Matt Borgerson
concerning this topic. Basic ideas and a few examples were taken  from this publication to illustrate the technology.
One can look at the examples of the  <tt class="docutils literal">pyinstaller</tt> application by reading the corresponded <tt class="docutils literal"><span class="pre">HOW-TO</span></tt>:</p>
<div class="highlight"><pre>cat pyinstaller/HOW-TO
</pre></div>
<!-- the text below can be obtained running a command ``./rsTCodeBlockProducer.sh bash pyinstaller/HOW-TO`` -->
<div class="highlight"><pre><span class="c"># installation of the wxPython</span>
sudo apt-get install python-wxgtk2.8

<span class="c"># installation of the Pyinstaller</span>
sudo pip install pyinstaller

<span class="c"># test 1: a windowed application</span>
pyinstaller --onefile --windowed window_app.py

<span class="c"># test 2: a simple script utilizing numpy and pandas</span>
<span class="c"># -d for debugging purpose</span>
pyinstaller --onefile -d numpy_pandas_test.py
</pre></div>
<p>The fist appication <tt class="docutils literal">window_app.py</tt> is a simple <tt class="docutils literal">Hello World</tt> windowed application built on top of the cross-platform <tt class="docutils literal">wxWidgets</tt>
<a class="reference external" href="http://www.wxpython.org/">C++ library</a> <a class="footnote-reference" href="#id55" id="id56">[13]</a>  helping to create appications  for Windows, Mac OS X, Linux and other platforms with a single code base.</p>
<p>The code of the python script is shown below.</p>
<!-- the text below can be obtained running a command ``./rsTCodeBlockProducer.sh python pyinstaller/window_app.py`` -->
<div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="kn">import</span> <span class="nn">wx</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">App</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="s">&quot;Hello World&quot;</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">()</span>
</pre></div>
<p>We can easily compile it to the binary</p>
<div class="highlight"><pre><span class="nb">cd </span>pyinstaller
pyinstaller --onefile --windowed window_app.py
</pre></div>
<p>and test the obtained file.</p>
<div class="highlight"><pre><span class="c"># you can start a window by a command</span>
<span class="c">#./dist/window_app</span>

ldd dist/window_app
</pre></div>
<pre class="doctest-block">
&gt;&gt;&gt;     linux-gate.so.1 =&gt;  (0xb776b000)
&gt;&gt;&gt;     libdl.so.2 =&gt; /lib/i386-linux-gnu/i686/cmov/libdl.so.2 (0xb774d000)
&gt;&gt;&gt;     libz.so.1 =&gt; /lib/i386-linux-gnu/libz.so.1 (0xb7734000)
&gt;&gt;&gt;     libc.so.6 =&gt; /lib/i386-linux-gnu/i686/cmov/libc.so.6 (0xb75cf000)
&gt;&gt;&gt;     /lib/ld-linux.so.2 (0xb776c000)
</pre>
<p>The next example demostrates building a binary from a python script intened to be used in
some data analysis. This script utilizes pandas and numpy libraries. To run the <tt class="docutils literal">pyinstaller</tt> on the script properly, you need to install
<tt class="docutils literal"><span class="pre">libgdk-pixbuf2.0-dev</span></tt>, <a class="reference external" href="http://stackoverflow.com/questions/35020183/pyinstaller-not-compiling-large-program-in-python2-7-64-bit-ubuntu">ref_about_proble</a> <a class="footnote-reference" href="#id57" id="id58">[14]</a>.</p>
<div class="highlight"><pre>sudo apt-get install libgdk-pixbuf2.0-dev
</pre></div>
<!-- obtained with ``./rsTCodeBlockProducer.sh python pyinstaller/numpy_pandas_test.py`` -->
<!-- required a few hacks: add "src_root_path_or_glob = src_root_path_or_glob.split('\n')[-1]" @  line 421 of /usr/local/lib/python2.7/dist-packages/PyInstaller/building/utils.py
add
 try:
  import re
  m=re.search('\{.*\}',txt,re.DOTALL)
  txt = m.group(0)
 except:
   return ''

 @ line 127 of  /usr/local/lib/python2.7/dist-packages/PyInstaller/utils/hooks/__init__.py -->
<p>Afterwards, the script</p>
<div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>


<span class="c"># Main Program starts here</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
 <span class="kn">import</span> <span class="nn">sys</span>
 <span class="n">sys</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;/usr/local/lib/python2.7/dist-packages&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span> <span class="c"># to fix the problem with numpy: this replaces  1.6 version by 1.9</span>

 <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span>
 <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
 <span class="c"># it doesn&#39;t work because of the incompatibility with numpy installed in my VM</span>
 <span class="c">#import pandas as pd</span>

 <span class="c"># 1) print a numpy array</span>
 <span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>

 <span class="c"># it doesn&#39;t work because of the incompatibility with numpy installed in my VM</span>
 <span class="c"># 2) take a look at the dataset</span>
 <span class="c">#df = pd.read_csv(&quot;train.csv&quot;)</span>
 <span class="c">#print &#39;**&#39;*60,&#39;\n&#39;</span>
 <span class="c">#print df.head()</span>
 <span class="c">#print &#39;**&#39;*60,&#39;\n&#39;</span>

<span class="n">main</span><span class="p">()</span>
</pre></div>
<p>can be compiled and run.</p>
<div class="highlight"><pre><span class="nb">cd </span>pyinstaller
pyinstaller --onefile numpy_pandas_test.py
dist/numpy_pandas_test
ldd dist/numpy_pandas_test
</pre></div>
<pre class="doctest-block">
&gt;&gt;&gt;    ['/usr/local/lib/python2.7/dist-packages', '/tmp/_MEItpKh8l']
&gt;&gt;&gt;    [1 2 3 4]
</pre>
<pre class="doctest-block">
&gt;&gt;&gt;    linux-gate.so.1 =&gt;  (0xb77a5000)
&gt;&gt;&gt;    libdl.so.2 =&gt; /lib/i386-linux-gnu/i686/cmov/libdl.so.2 (0xb7785000)
&gt;&gt;&gt;    libz.so.1 =&gt; /lib/i386-linux-gnu/libz.so.1 (0xb776c000)
&gt;&gt;&gt;    libc.so.6 =&gt; /lib/i386-linux-gnu/i686/cmov/libc.so.6 (0xb7607000)
&gt;&gt;&gt;    /lib/ld-linux.so.2 (0xb77a6000)
</pre>
<p>If you test this binary on a machine with other version of the Linux, say,
for example, Ubuntu with 64-bit architecture,</p>
<div class="highlight"><pre>lsb_release -a
uname -m
</pre></div>
<pre class="doctest-block">
&gt;&gt;&gt;    No LSB modules are available.
&gt;&gt;&gt;    Distributor ID:  Ubuntu
&gt;&gt;&gt;    Description:     Ubuntu 14.04.3 LTS
&gt;&gt;&gt;    Release: 14.04
&gt;&gt;&gt;    Codename:        trusty
</pre>
<pre class="doctest-block">
&gt;&gt;&gt;    x86_64
</pre>
<p>you will probably get either an error of the missing <a class="reference external" href="http://stackoverflow.com/questions/2716702/no-such-file-or-directory-error-when-executing-a-binary">32-bit dynamic loader</a> <a class="footnote-reference" href="#id59" id="id60">[15]</a> <tt class="docutils literal"><span class="pre">ld-linux.so.2</span></tt>  like</p>
<pre class="doctest-block">
&gt;&gt;&gt; ./numpy_pandas_test :error “No such file or directory”
</pre>
<p>or an error of the missing dynamic libraries like <tt class="docutils literal">libz.so.1</tt>.</p>
<pre class="doctest-block">
&gt;&gt;&gt; ./numpy_pandas_test: error while loading shared libraries: libz.so.1: cannot open shared object file: No such file or directory
</pre>
<p>The first problem can be solved by installing the 32-bit loader and the 32-bit Standard C library.</p>
<div class="highlight"><pre>sudo apt-get install libc6-i386 lib32stdc++6 lib32gcc1 lib32ncurses5 lib32z1
</pre></div>
<p>The second one reqiures more sophisticated solution. I provide it via the scripts <tt class="docutils literal">build_package.sh</tt> and <tt class="docutils literal">statifier.py</tt>.</p>
<div class="highlight"><pre>ls pyinstaller/<span class="o">{</span>build_package,statifier<span class="o">}</span>*
</pre></div>
<pre class="doctest-block">
&gt;&gt;&gt; pyinstaller/build_package.sh  pyinstaller/statifier.py
</pre>
<p>You simply build the package with all need dynamic libraries inside,</p>
<div class="highlight"><pre><span class="nb">cd  </span>pyinstaller
pyinstaller --onefile numpy_pandas_test.py
ln -s dist/numpy_pandas_test numpy_pandas_test<span class="p">;</span> ./build_package.sh numpy_pandas_test<span class="p">;</span> rm numpy_pandas_test
</pre></div>
<p>then you copy it to the remote machine (VM, Docker Container etc) with a different OS</p>
<div class="highlight"><pre>scp vagrant@172.17.0.1:/home/vagrant/project/package_numpy_pandas_test.tgz
</pre></div>
<p>and execute it here.</p>
<div class="highlight"><pre>tar -xf package_numpy_pandas_test.tgz
<span class="nb">cd </span>package_numpy_pandas_test/
./numpy_pandas_test
</pre></div>
<pre class="doctest-block">
&gt;&gt;&gt;    ['/usr/local/lib/python2.7/dist-packages', '/tmp/_MEItpKh8l']
&gt;&gt;&gt;    [1 2 3 4]
</pre>
<p>To close the topic about <tt class="docutils literal">pyinstaller</tt>, I want to add that  <tt class="docutils literal">pyinstaller</tt> makes packaging of all python modules and
extenstions <tt class="docutils literal"><span class="pre">(*.so</span> files found in the python modules)</tt>,  which are being &quot;imported&quot; in the script, and the python runtime environment
in one executable file or directory.</p>
</div>
<div class="section" id="how-to-compile-python-scripts-with-cython">
<h3><a class="toc-backref" href="#id91">How to compile python scripts with <tt class="docutils literal">Cython</tt></a></h3>
<p>As the <a class="reference external" href="https://github.com/cython/cython/wiki/EmbeddingCython">Cython wiki</a> <a class="footnote-reference" href="#id61" id="id62">[16]</a> suggests,</p>
<pre class="doctest-block">
&gt;&gt;&gt;   Typically Cython is used to create extension modules for use from Python programs.
&gt;&gt;&gt;   It is, however, possible to write a standalone programs in Cython.
&gt;&gt;&gt;   This is done via embedding the Python interpreter with the --embed option.
</pre>
<p>we can build C programs from python scripts. To prove this approach, we have to install <tt class="docutils literal">Cython</tt> first.</p>
<p>I refer you to  the instructions on installation of the <tt class="docutils literal">Cython</tt> found in the file <tt class="docutils literal"><span class="pre">cython/HOW-TO</span></tt>.</p>
<!-- obtained with ``./rsTCodeBlockProducer.sh bash cython/HOW-TO`` -->
<div class="highlight"><pre><span class="c"># How to install Cython</span>
<span class="c"># https://pypi.python.org/pypi/Cython/</span>

<span class="c"># method 1</span>
<span class="c"># pip install Cython --install-option=&quot;--no-cython-compile&quot;</span>

<span class="c"># method 2, https://github.com/cython/cython/wiki/Installing</span>
wget http://cython.org/release/Cython-0.24.tar.gz
tar -xf Cython-0.24.tar.gz
<span class="nb">cd </span>Cython-0.24/
sudo python setup.py install

<span class="c"># to build a binary from a python script</span>
make
</pre></div>
<p>If <tt class="docutils literal">Cython</tt> has been successfully installed, you can look at the python script which we are going to translate to a C standalone program.</p>
<!-- obtained with ``./rsTCodeBlockProducer.sh python cython/titanic_logistic_regression_grid_search_roc_plot_example.py`` -->
<div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="sd">&#39;&#39;&#39; This is an example of the application of the Logistic fucntion to the dataset analysis.</span>
<span class="sd">    Logistic function is helpful to model binary models</span>

<span class="sd">    This is a analysis with dedicated sklearn sub-modules.</span>

<span class="sd">    The basic idea is taken from</span>
<span class="sd">    http://scikit-learn.org/stable/auto_examples/linear_model/plot_iris_logistic.html#example-linear-model-plot-iris-logistic-py</span>
<span class="sd">    http://scikit-learn.org/stable/auto_examples/grid_search_digits.html</span>
<span class="sd">    http://www.pyimagesearch.com/2014/06/23/applying-deep-learning-rbm-mnist-using-python/</span>

<span class="sd">    DataFrameImputer was taken from</span>
<span class="sd">    http://stackoverflow.com/questions/25239958/impute-categorical-missing-values-in-scikit-learn</span>

<span class="sd">    About Precision and Recall</span>
<span class="sd">    http://en.wikipedia.org/wiki/Precision_and_recall</span>

<span class="sd">    About Type 1 and Type 2 errors</span>
<span class="sd">    http://en.wikipedia.org/wiki/Type_I_and_type_II_errors</span>

<span class="sd">    About scorring parameters for sklearn classifiers</span>
<span class="sd">    http://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter</span>

<span class="sd">    About plottig ROC in sklearn</span>
<span class="sd">    http://scikit-learn.org/stable/auto_examples/plot_roc_crossval.html</span>

<span class="sd">    About plottig Precision vs Recall in sklearn</span>
<span class="sd">    http://scikit-learn.org/stable/auto_examples/plot_precision_recall.html</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;/usr/local/lib/python2.7/dist-packages&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span> <span class="c"># to fix the problem with numpy: this replaces  1.6 version by 1.9</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">ExtraTreesClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">Imputer</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">TransformerMixin</span>
<span class="kn">from</span> <span class="nn">StringIO</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">import</span> <span class="nn">prettytable</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="kn">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="kn">as</span> <span class="nn">pl</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.grid_search</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span><span class="p">,</span><span class="n">precision_recall_curve</span>

<span class="k">class</span> <span class="nc">DataFrameImputer</span><span class="p">(</span><span class="n">TransformerMixin</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Impute missing values.</span>

<span class="sd">        Columns of dtype object are imputed with the most frequent value</span>
<span class="sd">        in column.</span>

<span class="sd">        Columns of other types are imputed with mean of column.</span>

<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">X</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">X</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s">&#39;O&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">X</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">X</span><span class="p">],</span>
            <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">X</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">transform_data</span><span class="p">(</span><span class="n">train_df</span><span class="p">,</span><span class="n">input_variable_names</span><span class="p">):</span>
 <span class="sd">&#39;&#39;&#39; transform categorial data in train_df to numerical&#39;&#39;&#39;</span>


 <span class="n">input_variable_types</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">&#39;string&#39;</span> <span class="k">if</span> <span class="s">&#39;object&#39;</span> <span class="ow">in</span> <span class="n">train_df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">ftypes</span> <span class="k">else</span> <span class="n">train_df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">ftypes</span><span class="p">,</span><span class="n">input_variable_names</span> <span class="p">)</span>
 <span class="n">labelencoders</span> <span class="o">=</span> <span class="p">[]</span>


 <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">input_variable_types</span><span class="p">):</span>
<span class="c">## here transform string label to numeric labels</span>
  <span class="k">if</span> <span class="s">&#39;string&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
   <span class="n">values</span> <span class="o">=</span>  <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span><span class="o">!=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">else</span> <span class="s">&#39;NaN&#39;</span> <span class="p">,</span><span class="n">train_df</span><span class="p">[</span><span class="n">input_variable_names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">get_values</span><span class="p">())</span>
   <span class="n">labelencoders</span><span class="o">+=</span><span class="p">[</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">LabelEncoder</span><span class="p">()]</span>
   <span class="n">labelencoders</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
   <span class="n">train_df</span><span class="p">[</span><span class="n">input_variable_names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span>  <span class="n">train_df</span><span class="p">[</span><span class="n">input_variable_names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">labelencoders</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

 <span class="k">return</span> <span class="n">labelencoders</span>


<span class="c"># 1) get data for an analysis</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">&quot;train.csv&quot;</span><span class="p">)</span>

<span class="c"># 2) take a look at the dataset</span>
<span class="k">print</span> <span class="s">&#39;**&#39;</span><span class="o">*</span><span class="mi">60</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
<span class="k">print</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&#39;**&#39;</span><span class="o">*</span><span class="mi">60</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

<span class="c"># 3) summarize data</span>
<span class="k">print</span> <span class="s">&#39;**&#39;</span><span class="o">*</span><span class="mi">60</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
<span class="k">print</span> <span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&#39;**&#39;</span><span class="o">*</span><span class="mi">60</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

<span class="c"># 6) we are going to analyze a regressiong factors between &#39;Survied&#39; as a target and Pclass,Sex,Age,Fare,Embarked</span>
<span class="c"># also we introduce dummy categories for all of the Pclass,Sex,Embarked  to do this analysis.</span>
<span class="n">input_variable_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Pclass&#39;</span><span class="p">,</span><span class="s">&#39;Sex&#39;</span><span class="p">,</span><span class="s">&#39;Embarked&#39;</span><span class="p">,</span><span class="s">&#39;Age&#39;</span><span class="p">,</span><span class="s">&#39;Fare&#39;</span><span class="p">]</span>

<span class="c"># we need to understand the type of variables</span>
<span class="n">input_variable_types</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">&#39;string&#39;</span> <span class="k">if</span> <span class="s">&#39;object&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">ftypes</span> <span class="k">else</span> <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">ftypes</span><span class="p">,</span><span class="n">input_variable_names</span> <span class="p">)</span>

<span class="c"># do variable transformation</span>
<span class="n">encoders</span> <span class="o">=</span> <span class="n">transform_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">input_variable_names</span><span class="p">)</span>

<span class="c"># apply  DataFrameImputer to fix np.nan</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">DataFrameImputer</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="n">cols_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Survived&#39;</span><span class="p">,</span><span class="s">&#39;Pclass&#39;</span><span class="p">,</span><span class="s">&#39;Sex&#39;</span><span class="p">,</span><span class="s">&#39;Embarked&#39;</span><span class="p">,</span><span class="s">&#39;Age&#39;</span><span class="p">,</span><span class="s">&#39;Fare&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cols_to_keep</span><span class="p">]</span>


<span class="k">print</span> <span class="s">&#39;**&#39;</span><span class="o">*</span><span class="mi">60</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
<span class="k">print</span> <span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&#39;**&#39;</span><span class="o">*</span><span class="mi">60</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

<span class="c"># 7) split the sample for train and test sub-samples</span>
<span class="c"># Split the dataset in two equal parts</span>
<span class="n">train_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Pclass&#39;</span><span class="p">,</span><span class="s">&#39;Sex&#39;</span><span class="p">,</span><span class="s">&#39;Embarked&#39;</span><span class="p">,</span><span class="s">&#39;Age&#39;</span><span class="p">,</span><span class="s">&#39;Fare&#39;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">train_cols</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Survived&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c"># Set the parameters by cross-validation and scores</span>
<span class="n">tuned_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span><span class="mf">1e5</span><span class="p">,</span><span class="mf">1e6</span><span class="p">]}</span>
<span class="c"># the whole list of scoring types can be found here:</span>
<span class="c"># http://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter</span>

<span class="c"># choose the best &#39;recall&#39; strategy and start the grid</span>
<span class="n">scoring</span> <span class="o">=</span> <span class="s">&#39;recall&#39;</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">linear_model</span><span class="o">.</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">1e5</span><span class="p">),</span> <span class="n">tuned_parameters</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span> <span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Best parameters:&quot;</span><span class="p">)</span>
<span class="n">bestParams</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tuned_parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
  <span class="k">print</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s"> </span><span class="si">%s</span><span class="s">: </span><span class="si">%f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">bestParams</span><span class="p">[</span><span class="n">p</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;Detailed classification report:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;The model is trained on the full development set.&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;The scores are computed on the full evaluation set.&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>
<span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">clf</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="k">print</span><span class="p">()</span>


<span class="c"># 9) Compute ROC curve and area under the curve</span>
<span class="n">probas_</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">probas_</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;ROC (area = </span><span class="si">%0.2f</span><span class="s">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">roc_auc</span><span class="p">))</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Luck&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;False Positive Rate (FPR or Type-1 error )&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;True Positive Rate (TPR or recall or Type-2 error)&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Receiver operating characteristic example&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c"># 10) Compute Precision (PositivePredictiveValue=TP/(TP+FP))  vs recall (TPR=P/(TP+FN))</span>
<span class="c"># http://scikit-learn.org/stable/auto_examples/plot_precision_recall.html</span>
<span class="n">ppv</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">precision_recall_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">probas_</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">tpr</span><span class="p">,</span> <span class="n">ppv</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tpr</span><span class="p">,</span> <span class="n">ppv</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Precsion-Recall curve (area = </span><span class="si">%0.2f</span><span class="s">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">roc_auc</span><span class="p">))</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;PPV (or precision)&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;True Positive Rate (TPR or recall)&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Precsion-Recall Curve example&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Press the Enter key...&quot;</span><span class="p">)</span>
</pre></div>
<p>This is a simple example of the Logistic Regression analysis, which I wrote a few years ago during my experiments with the <a class="reference external" href="http://scikit-learn.org/stable/">scikit-learn package</a> <a class="footnote-reference" href="#id63" id="id64">[17]</a>  to
solve the problem given at the <a class="reference external" href="https://www.kaggle.com/c/titanic">Kaggle Competition 2012</a> <a class="footnote-reference" href="#id65" id="id66">[18]</a>, <strong>Titanic: Machine Learning from Disaster</strong>. The script does nothing except training
the Logistic regressor with optimized parameters and calculating ROC, Precision-Recall curves for obtained model.</p>
<p>Let's build the executable binary, <tt class="docutils literal">embedded</tt> from the script <tt class="docutils literal">titanic_logistic_regression_grid_search_roc_plot_example.py</tt> and run it.</p>
<div class="highlight"><pre><span class="nb">cd </span>cython
make
./embedded
</pre></div>
<p>The result of both command is shown below.</p>
<div class="highlight"><pre>gcc -pthread -c titanic_logistic_regression_grid_search_roc_plot_example.c -I/usr/include/python2.7 -I/usr/include/python2.7
gcc -pthread -o embedded titanic_logistic_regression_grid_search_roc_plot_example.o -L/usr/lib -L/usr/lib/python2.7/config -lpython2.7 -lpthread -ldl  -lutil -lm -Xlinker -export-dynamic -Wl,-O1 -Wl,-Bsymbolic-functions


************************************************************************************************************************

   PassengerId  Survived  Pclass  <span class="se">\</span>
<span class="m">0</span>            <span class="m">1</span>         <span class="m">0</span>       3
<span class="m">1</span>            <span class="m">2</span>         <span class="m">1</span>       1
<span class="m">2</span>            <span class="m">3</span>         <span class="m">1</span>       3
<span class="m">3</span>            <span class="m">4</span>         <span class="m">1</span>       1
<span class="m">4</span>            <span class="m">5</span>         <span class="m">0</span>       3

                                                Name     Sex  Age  SibSp  <span class="se">\</span>
<span class="m">0</span>                            Braund, Mr. Owen Harris    male   <span class="m">22</span>      1
<span class="m">1</span>  Cumings, Mrs. John Bradley <span class="o">(</span>Florence Briggs Th...  female   <span class="m">38</span>      1
<span class="m">2</span>                             Heikkinen, Miss. Laina  female   <span class="m">26</span>      0
<span class="m">3</span>       Futrelle, Mrs. Jacques Heath <span class="o">(</span>Lily May Peel<span class="o">)</span>  female   <span class="m">35</span>      1
<span class="m">4</span>                           Allen, Mr. William Henry    male   <span class="m">35</span>      0

   Parch            Ticket     Fare Cabin Embarked
<span class="m">0</span>      <span class="m">0</span>         A/5 <span class="m">21171</span>   7.2500   NaN        S
<span class="m">1</span>      <span class="m">0</span>          PC <span class="m">17599</span>  71.2833   C85        C
<span class="m">2</span>      <span class="m">0</span>  STON/O2. <span class="m">3101282</span>   7.9250   NaN        S
<span class="m">3</span>      <span class="m">0</span>            <span class="m">113803</span>  53.1000  C123        S
<span class="m">4</span>      <span class="m">0</span>            <span class="m">373450</span>   8.0500   NaN        S
************************************************************************************************************************

************************************************************************************************************************

       PassengerId    Survived      Pclass         Age       SibSp  <span class="se">\</span>
count   891.000000  891.000000  891.000000  714.000000  891.000000
mean    446.000000    0.383838    2.308642   29.699118    0.523008
std     257.353842    0.486592    0.836071   14.526497    1.102743
min       1.000000    0.000000    1.000000    0.420000    0.000000
25%     223.500000    0.000000    2.000000   20.125000    0.000000
50%     446.000000    0.000000    3.000000   28.000000    0.000000
75%     668.500000    1.000000    3.000000   38.000000    1.000000
max     891.000000    1.000000    3.000000   80.000000    8.000000

            Parch        Fare
count  891.000000  891.000000
mean     0.381594   32.204208
std      0.806057   49.693429
min      0.000000    0.000000
25%      0.000000    7.910400
50%      0.000000   14.454200
75%      0.000000   31.000000
max      6.000000  512.329200
************************************************************************************************************************

************************************************************************************************************************

   Survived  Pclass  Sex  Embarked  Age     Fare
<span class="m">0</span>         <span class="m">0</span>       <span class="m">3</span>    <span class="m">1</span>         <span class="m">2</span>   <span class="m">22</span>   7.2500
<span class="m">1</span>         <span class="m">1</span>       <span class="m">1</span>    <span class="m">0</span>         <span class="m">0</span>   <span class="m">38</span>  71.2833
<span class="m">2</span>         <span class="m">1</span>       <span class="m">3</span>    <span class="m">0</span>         <span class="m">2</span>   <span class="m">26</span>   7.9250
<span class="m">3</span>         <span class="m">1</span>       <span class="m">1</span>    <span class="m">0</span>         <span class="m">2</span>   <span class="m">35</span>  53.1000
<span class="m">4</span>         <span class="m">0</span>       <span class="m">3</span>    <span class="m">1</span>         <span class="m">2</span>   <span class="m">35</span>   8.0500
************************************************************************************************************************

Fitting <span class="m">5</span> folds <span class="k">for</span> each of <span class="m">6</span> candidates, totalling <span class="m">30</span> fits
<span class="o">[</span>Parallel<span class="o">(</span><span class="nv">n_jobs</span><span class="o">=</span>-1<span class="o">)]</span>: Done   <span class="m">1</span> <span class="nb">jobs</span>       <span class="p">|</span> elapsed:    0.0s
<span class="o">[</span>Parallel<span class="o">(</span><span class="nv">n_jobs</span><span class="o">=</span>-1<span class="o">)]</span>: Done  <span class="m">28</span> out of  <span class="m">30</span> <span class="p">|</span> elapsed:    0.2s remaining:    0.0s
<span class="o">[</span>Parallel<span class="o">(</span><span class="nv">n_jobs</span><span class="o">=</span>-1<span class="o">)]</span>: Done  <span class="m">30</span> out of  <span class="m">30</span> <span class="p">|</span> elapsed:    0.2s finished

Best parameters:
      C: 10.000000
Detailed classification report:
<span class="o">()</span>
The model is trained on the full development set.
The scores are computed on the full evaluation set.
<span class="o">()</span>
             precision    recall  f1-score   support

          <span class="m">0</span>       0.84      0.82      0.83       283
          <span class="m">1</span>       0.69      0.72      0.71       163

avg / total       0.78      0.78      0.78       446

<span class="o">()</span>
Press the Enter key...
</pre></div>
<p>The figures below illustrate ROC and Rrecision-Recall curve of the model predicting survival probability  in the <tt class="docutils literal"><span class="pre">Titanic-Disaster</span></tt> problem</p>
<div class="figure align-center">
<img alt="ROC of the model" src="/images/figure_1.png" style="width: 570.0px; height: 320.0px;" />
<p class="caption">ROC of the model</p>
</div>
<div class="figure align-center">
<img alt="Rrecision-Recall curve of the model" src="/images/figure_2.png" style="width: 570.0px; height: 320.0px;" />
<p class="caption">Rrecision-Recall curve of the model</p>
</div>
<p>The result looks good. There is a question that we would like to answer:</p>
<pre class="doctest-block">
&gt;&gt;&gt; Is the obtained binary portable or not?
</pre>
<p>The answer is &quot;NOT&quot;. If you run it somewhere else, you will likely get something like this</p>
<pre class="doctest-block">
&gt;&gt;&gt;   ./embedded: error while loading shared libraries: libpython2.7.so.1.0: cannot open shared object file: No such file or directory
</pre>
<p>or</p>
<pre class="doctest-block">
&gt;&gt;&gt;  ./embedded:   'import site' failed; use -v for traceback
</pre>
<p>Can we fix the problem?</p>
<p>Yes. We can.</p>
<p>Later in the tutorial,  I will demonstrate a tool, built on top of <tt class="docutils literal">Go</tt>, <tt class="docutils literal">GCCGO</tt> and <tt class="docutils literal">SWIG</tt> compilers which allows to build and package
such Machine-Learning python script in one  portable  binary.
But before we test this tool, let's consider a few basic examples showing how one can obtain statically linked binaries from Python/C++ applications
with help of the  <tt class="docutils literal">GO</tt> compiler.</p>
</div>
<div class="section" id="cgo-go-binding-for-c-c">
<h3><a class="toc-backref" href="#id92">CGO: GO Binding for C/C++</a></h3>
<p>As I said previously, <tt class="docutils literal">GO</tt> makes  the <a class="reference external" href="https://github.com/golang/go/wiki/WindowsCrossCompiling">cross-compiling of code is very easy</a> <a class="footnote-reference" href="#id67" id="id68">[19]</a>.  If you have <tt class="docutils literal"><span class="pre">GO&gt;=1.5</span></tt> installed on Linux, there is no problem to build
the windows <tt class="docutils literal">*.exe</tt> binary from the GO code at this linux machine</p>
<div class="highlight"><pre>cat hello.go
</pre></div>
<pre class="doctest-block">
&gt;&gt;&gt;   package main
&gt;&gt;&gt;
&gt;&gt;&gt;   import &quot;fmt&quot;
&gt;&gt;&gt;
&gt;&gt;&gt;   func main() {
&gt;&gt;&gt;        fmt.Printf(&quot;Hello\n&quot;)
&gt;&gt;&gt;   }
</pre>
<div class="highlight"><pre><span class="nv">GOOS</span><span class="o">=</span>windows <span class="nv">GOARCH</span><span class="o">=</span><span class="m">386</span> go build -o hello.exe hello.go
</pre></div>
<p>That's it. Why not to try to exploit this nice feature of the <tt class="docutils literal">GO</tt> to build cross-paltform applications from C++.</p>
<div class="section" id="xgo-cgo-cross-compiler">
<h4><a class="toc-backref" href="#id93">XGO - CGO cross compiler</a></h4>
<p>For example, let's imagine, that I have developed a C++ program/API at the Linux machine. I want to start it at a computer running Microsoft Windows OS.
How to cross compile C++ for the MS Windows Machine without developing own C++ build toolchain of the compilers and libraries? Can we do it as easy as possible?</p>
<p>There is a tool called <tt class="docutils literal">XGO</tt>, <a class="reference external" href="https://github.com/karalabe/xgo">GO/CGO cross compiler</a> <a class="footnote-reference" href="#id69" id="id70">[20]</a>, developed by Peter Szilagyi. Using LXC (Linux Containers) aka Docker containers, the <tt class="docutils literal">XGO</tt>
allows to build from ANY <tt class="docutils literal">GO</tt> project  an executable for any platform supported by  <tt class="docutils literal">GO</tt>.  Here I highlight ANY because I want to stress that ANY includes
also <tt class="docutils literal">CGO</tt> projects.  In general, the <tt class="docutils literal">CGO</tt> is a layer of stubs allowing to call C functions in GO environment. Also CGO allows to embed C++  code into the <tt class="docutils literal">GO</tt>
program.</p>
<p>What doest it mean?
We can release our C++ project for any platform and OS without big efforts, if we utilize <tt class="docutils literal">XGO</tt> for the cross-compiling.</p>
<p>But, first, let's try to play with the <tt class="docutils literal">CGO</tt>.  I have prepared a small sub-project <tt class="docutils literal"><span class="pre">cgo-cpp</span></tt> which shows basic ideas of binding C++ with the  <tt class="docutils literal">GO</tt> runtime.
If you build the project, using the proposed <tt class="docutils literal">Makefile</tt>,</p>
<div class="highlight"><pre><span class="nb">cd </span>cgo-cpp
make
</pre></div>
<p>you will get a statically linked binary <tt class="docutils literal"><span class="pre">prog/prog-static</span></tt> which is executable on many linux-based 32/64-bit architecures.</p>
<div class="highlight"><pre>ld prog/prog-static
prog/prog-static
</pre></div>
<pre class="doctest-block">
&gt;&gt;&gt;     not a dynamic executable
&gt;&gt;&gt;     Generator is built
&gt;&gt;&gt;     Characters: a A
&gt;&gt;&gt;     Decimals: 1977 650000
&gt;&gt;&gt;     Preceding with blanks:       1977
&gt;&gt;&gt;     Preceding with zeros: 0000001977
&gt;&gt;&gt;     Some different radices: 100 64 144 0x64 0144
&gt;&gt;&gt;     floats: 3.14 +3e+00 3.141600E+00
&gt;&gt;&gt;     Width trick:    10
&gt;&gt;&gt;     A string
&gt;&gt;&gt;     1804289383
</pre>
<p>It looks promising. What is about <tt class="docutils literal">XGO</tt>? How can we use it  in this particular example? I have prepared another <a class="reference external" href="https://bitbucket.org/iggy_floyd/xgo-cpp/">sub-project</a> <a class="footnote-reference" href="#id71" id="id72">[21]</a>, <tt class="docutils literal"><span class="pre">xgo-cpp</span></tt> being made as a replica of
the <tt class="docutils literal"><span class="pre">cgo-cpp</span></tt> adopted  to <tt class="docutils literal">XGO</tt>.</p>
<p>It is worth to mention that, to use the <tt class="docutils literal">XGO</tt>, and as a result, <tt class="docutils literal">Docker</tt> containers,  we need to switch from the 32-bit VM to 64-bit VM.
All further tests and exercises are made in the VM with the following OS installed:</p>
<div class="highlight"><pre>uname -m
lsb_release -a
</pre></div>
<pre class="doctest-block">
&gt;&gt;&gt;  x86_64
&gt;&gt;&gt;  Distributor ID:    Debian
&gt;&gt;&gt;  Description:       Debian GNU/Linux 8.1 (jessie)
&gt;&gt;&gt;  Release:   8.1
&gt;&gt;&gt;  Codename:  jessie
</pre>
<p>I suggest that you have installed the <tt class="docutils literal">Docker</tt> system at your machine. If it's so, I recommend you to look at a few  <tt class="docutils literal">&quot;Getting started with XGO&quot;</tt> instructions.</p>
<div class="highlight"><pre><span class="nb">cd </span>xgo-cpp
cat HOW-TO
</pre></div>
<p>The content of the <tt class="docutils literal"><span class="pre">HOW-TO</span></tt> is the following.</p>
<div class="highlight"><pre><span class="c">### A simple HOW-TO on making cross-platform compilation with GO</span>
<span class="c">### A docker system is required!</span>
<span class="c">###</span>
<span class="c">###</span>
<span class="c">###</span>

<span class="c">## Installation of the GO tools: it uses user-defined paths of installation!</span>
<span class="c">## To delete them, simply remove the folder (&#39;xgo&#39;,here)!</span>

<span class="c"># build the temporary folders where we put our GO/XGO installation stuff</span>
mkdir -p xgo/go
mkdir -p xgo/go-modules

<span class="c"># download the latest go runtime environment</span>
wget https://storage.googleapis.com/golang/go1.6.2.linux-amd64.tar.gz -O xgo/go1.6.2.linux-amd64.tar.gz

<span class="c"># unpack the go runtime environment</span>
tar -C xgo/ -xzf xgo/go1.6.2.linux-amd64.tar.gz


<span class="c"># a simple script for initialization of the go runtime</span>
cat &gt; xgo/ini_go.sh <span class="s">&lt;&lt;_END</span>
<span class="s">#!/bin/sh</span>

<span class="s">export GOROOT=`pwd`/xgo/go</span>
<span class="s">export GOPATH=`pwd`/xgo/go-modules</span>

<span class="s">export PATH=\$PATH:\$GOROOT/bin:\$GOPATH/bin</span>

<span class="s">_END</span>
chmod a+rwx xgo/ini_go.sh

<span class="c"># initialization of the GO and check version of the GO</span>
<span class="nb">source </span>xgo/ini_go.sh
go version

<span class="c"># get a XGO project  and check it</span>
go get github.com/karalabe/xgo
ls <span class="nv">$GOPATH</span>/src/github.com/karalabe/xgo
ls <span class="nv">$GOPATH</span>/bin


<span class="c"># a smoke test of the XGO: build xgo/tests/embedded_cpp subproject of the XGO</span>
mkdir -p xgo/test
<span class="nb">cd </span>xgo/test
<span class="c"># build a statically linked program for &#39;linux/amd64&#39; target</span>
sudo <span class="sb">`</span>which xgo<span class="sb">`</span> -go 1.6.1 -targets<span class="o">=</span>linux/amd64  -ldflags <span class="s1">&#39;-extldflags &quot;-static&quot;&#39;</span>  -out embedded_cpp.0.0.1 github.com/karalabe/xgo/tests/embedded_cpp

...
</pre></div>
<p>As you see, it is quite easy to install the <tt class="docutils literal">GO</tt> and <tt class="docutils literal">XGO</tt> runtime. You can immediately test the <tt class="docutils literal">XGO</tt> cross-compilation for different platforms like
<tt class="docutils literal">linux/amd64, linux/386, <span class="pre">windows-6.0/*,</span> <span class="pre">ios-8.1/*</span></tt> etc.  The <tt class="docutils literal">github.com/karalabe/xgo/tests/embedded_cpp</tt> project illustrates  embedded C++ code in <tt class="docutils literal">GO</tt> sources.
Let's try to compile it.</p>
<div class="highlight"><pre><span class="nb">cd </span>xgo/test
<span class="c"># testing the cross-platform compilation of  a smoke test from XGO</span>
<span class="nv">targets</span><span class="o">=</span><span class="s2">&quot;linux/amd64 linux/386 windows-6.0/* ios-8.1/*&quot;</span>
<span class="k">for</span> target in <span class="k">$(</span><span class="nb">echo</span> <span class="nv">$targets</span> <span class="p">|</span> tr <span class="s1">&#39; &#39;</span> <span class="s2">&quot;\n&quot;</span> <span class="k">)</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="nv">$target</span><span class="p">;</span><span class="se">\</span>
sudo <span class="sb">`</span>which xgo<span class="sb">`</span> -go 1.6.1 -targets<span class="o">=</span><span class="nv">$target</span> -ldflags <span class="s1">&#39;-extldflags &quot;-static&quot;&#39;</span> -out <span class="se">\</span>
embedded_cpp.0.0.1 github.com/karalabe/xgo/tests/embedded_cpp<span class="p">;</span> <span class="se">\</span>
<span class="k">done</span>
ls -rthl
</pre></div>
<p>These commands issue the output like it is shown below.</p>
<div class="highlight"><pre>...

Compiling <span class="k">for</span> ios-8.1/arm-7...
<span class="c"># github.com/karalabe/xgo/tests/embedded_cpp</span>
./snippet.cpp:6:10: fatal error: <span class="s1">&#39;iostream&#39;</span> file not found
 2016/04/29 15:29:44 Failed to cross compile package: <span class="nb">exit </span>status 2.

-rwxr-xr-x <span class="m">1</span> vagrant vagrant 3.5M Apr <span class="m">29</span> 15:29 embedded_cpp.0.0.1-linux-amd64
-rwxr-xr-x <span class="m">1</span> vagrant vagrant 3.1M Apr <span class="m">29</span> 15:29 embedded_cpp.0.0.1-linux-386
-rwxr-xr-x <span class="m">1</span> vagrant vagrant 2.6M Apr <span class="m">29</span> 15:29 embedded_cpp.0.0.1-windows-6.0-amd64.exe
-rwxr-xr-x <span class="m">1</span> vagrant vagrant 2.0M Apr <span class="m">29</span> 15:29 embedded_cpp.0.0.1-windows-6.0-386.exe
</pre></div>
<p>Everything runs smoothly except compilation for the <tt class="docutils literal"><span class="pre">ios-8.1/</span></tt> platform: it brings errors of missing C++ STL library in the <tt class="docutils literal">XGO</tt> compiler toolchain for the <tt class="docutils literal">OSX</tt>.
Here are examples of the cross-platform building my simple <tt class="docutils literal"><span class="pre">xgo-cpp</span></tt> project.</p>
<div class="highlight"><pre> <span class="nb">cd </span>xgo/test

 <span class="c"># linux: 64-bit architecture</span>
 <span class="c">#</span>

 <span class="c"># remove the cache of the previous exercise</span>
 sudo rm -r /root/.xgo-cache
 <span class="nv">targets</span><span class="o">=</span><span class="s2">&quot;linux/amd64&quot;</span>
 <span class="k">for</span> target in <span class="k">$(</span><span class="nb">echo</span> <span class="nv">$targets</span> <span class="p">|</span> tr <span class="s1">&#39; &#39;</span> <span class="s2">&quot;\n&quot;</span> <span class="k">)</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="nv">$target</span><span class="p">;</span><span class="se">\</span>
 sudo <span class="sb">`</span>which xgo<span class="sb">`</span> -go 1.6.1 -targets<span class="o">=</span><span class="nv">$target</span> -ldflags <span class="s1">&#39;-extldflags &quot;-static&quot;&#39;</span> -out <span class="se">\</span>
 xgo_example --deps<span class="o">=</span>https://bitbucket.org/iggy_floyd/xgo-cpp/downloads/xgo-cpp.tar.bz2 bitbucket.org/iggy_floyd/xgo-cpp/<span class="p">;</span><span class="se">\</span>
 <span class="k">done</span>

 <span class="c"># linux: 32-bit architecture</span>
 <span class="c">#</span>
 <span class="nv">targets</span><span class="o">=</span><span class="s2">&quot;linux/386&quot;</span>
 <span class="k">for</span> target in <span class="k">$(</span><span class="nb">echo</span> <span class="nv">$targets</span> <span class="p">|</span> tr <span class="s1">&#39; &#39;</span> <span class="s2">&quot;\n&quot;</span> <span class="k">)</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="nv">$target</span><span class="p">;</span><span class="se">\</span>
 sudo <span class="sb">`</span>which xgo<span class="sb">`</span> -v -x -go 1.6.1 -targets<span class="o">=</span><span class="nv">$target</span> -ldflags <span class="s1">&#39;-extldflags &quot;-static&quot;&#39;</span> -out <span class="se">\</span>
 xgo_example --deps<span class="o">=</span>https://bitbucket.org/iggy_floyd/xgo-cpp/downloads/xgo-cpp.tar.bz2 <span class="se">\</span>
 --depsargs<span class="o">=</span>-m32 bitbucket.org/iggy_floyd/xgo-cpp/<span class="p">;</span><span class="k">done</span>

 ls -rthl
./xgo_example-linux-386
</pre></div>
<p>And  this is the result.</p>
<div class="highlight"><pre>-rwxr-xr-x <span class="m">1</span> vagrant vagrant 4.0M Apr <span class="m">29</span> 15:58 xgo_example-linux-386
-rwxr-xr-x <span class="m">1</span> vagrant vagrant 4.6M Apr <span class="m">29</span> 15:59 xgo_example-linux-amd64

Generator is built
Characters: a A
Decimals: <span class="m">1977</span> 650000
Preceding with blanks:       1977
Preceding with zeros: 0000001977
Some different radices: <span class="m">100</span> <span class="m">64</span> <span class="m">144</span> 0x64 0144
floats: 3.14 +3e+00 3.141600E+00
Width trick:    10
A string
1804289383
</pre></div>
<p>It seems that <tt class="docutils literal">XGO</tt> works :-).</p>
</div>
</div>
<div class="section" id="connecting-go-and-python-together">
<h3><a class="toc-backref" href="#id94">Connecting GO and Python together</a></h3>
<p>Now it is time to make a bridge between <tt class="docutils literal">python</tt> and <tt class="docutils literal">GO</tt> that we could use to
compile python scripts in the cross-platform manner. OK. Let's go.</p>
<div class="section" id="binding-cgo-and-cython-together">
<h4><a class="toc-backref" href="#id95">Binding CGO and Cython together</a></h4>
<p>First, we will try to use the same approach we have followed previously: we want to exploit <tt class="docutils literal">CGO</tt> layer
to connect <tt class="docutils literal">*py</tt> scripts translated by <tt class="docutils literal">Cython</tt> with the <tt class="docutils literal">GO</tt> runtime in order to get a statically linked binary.</p>
<pre class="doctest-block">
&gt;&gt;&gt;  Python (script.py) --&gt; Cython (script.c) --&gt; CGO--&gt;GO --&gt; a statically linked binary ``script``
</pre>
<p>One can just have a look at another sub-project <tt class="docutils literal"><span class="pre">cgo-python</span></tt>.
The stucture and Makefile of the <tt class="docutils literal"><span class="pre">cgo-python``look</span> similar to ones in the <span class="pre">``cgo-cpp</span></tt>.</p>
<div class="highlight"><pre><span class="nb">cd </span>cgo-python
make

ldd prog/prog
<span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/lib  prog/prog
</pre></div>
<p>As a result of the run, we got the output</p>
<div class="highlight"><pre>linux-gate.so.1 <span class="o">=</span>&gt;  <span class="o">(</span>0xb77b0000<span class="o">)</span>
libcgo-python.so <span class="o">=</span>&gt; not found
libpython2.7.so.1.0 <span class="o">=</span>&gt; /usr/lib/libpython2.7.so.1.0 <span class="o">(</span>0xb74c6000<span class="o">)</span>
libpthread.so.0 <span class="o">=</span>&gt; /lib/i386-linux-gnu/i686/cmov/libpthread.so.0 <span class="o">(</span>0xb74ad000<span class="o">)</span>
libdl.so.2 <span class="o">=</span>&gt; /lib/i386-linux-gnu/i686/cmov/libdl.so.2 <span class="o">(</span>0xb74a9000<span class="o">)</span>
libutil.so.1 <span class="o">=</span>&gt; /lib/i386-linux-gnu/i686/cmov/libutil.so.1 <span class="o">(</span>0xb74a5000<span class="o">)</span>
libm.so.6 <span class="o">=</span>&gt; /lib/i386-linux-gnu/i686/cmov/libm.so.6 <span class="o">(</span>0xb747f000<span class="o">)</span>
libstdc++.so.6 <span class="o">=</span>&gt; /usr/lib/i386-linux-gnu/libstdc++.so.6 <span class="o">(</span>0xb7392000<span class="o">)</span>
libc.so.6 <span class="o">=</span>&gt; /lib/i386-linux-gnu/i686/cmov/libc.so.6 <span class="o">(</span>0xb722e000<span class="o">)</span>
libz.so.1 <span class="o">=</span>&gt; /lib/i386-linux-gnu/libz.so.1 <span class="o">(</span>0xb7215000<span class="o">)</span>
libgcc_s.so.1 <span class="o">=</span>&gt; /lib/i386-linux-gnu/libgcc_s.so.1 <span class="o">(</span>0xb71f8000<span class="o">)</span>
/lib/ld-linux.so.2 <span class="o">(</span>0xb77b1000<span class="o">)</span>

Characters: a A
Decimals: <span class="m">1977</span> 650000
Decimals: 1
Decimals: prog/prog
Preceding with blanks:       1977
Preceding with zeros: 0000001977
Some different radices: <span class="m">100</span> <span class="m">64</span> <span class="m">144</span> 0x64 0144
floats: 3.14 +3e+00 3.141600E+00
Width trick:    10
A string

fatal error: unexpected signal during runtime execution
<span class="o">[</span>signal 0xb <span class="nv">code</span><span class="o">=</span>0x2 <span class="nv">addr</span><span class="o">=</span>0x2 <span class="nv">pc</span><span class="o">=</span>0x8052cc4<span class="o">]</span>
runtime stack:
runtime.throw<span class="o">(</span>0x814a2c5<span class="o">)</span>
/usr/local/go/src/pkg/runtime/panic.c:520 +0x71
runtime.sigpanic<span class="o">()</span>
/usr/local/go/src/pkg/runtime/os_linux.c:222 +0x46
MHeap_Grow<span class="o">(</span>0x81598e0, 0x10<span class="o">)</span>

...
</pre></div>
<p>which explicitly shows that the <strong>application binary interface (ABI)</strong> produced by
<tt class="docutils literal">Cython</tt> is not compatible with the <tt class="docutils literal">GCO</tt>. This indicates that the <tt class="docutils literal">XGO</tt>
cross-platform compiler can not be used to build <tt class="docutils literal">cythonized</tt> files at the moment.
In addition, there is another problem.
If you look at the <a class="reference external" href="https://raw.githubusercontent.com/karalabe/xgo/master/docker/base/Dockerfile">build toolchain</a> <a class="footnote-reference" href="#id73" id="id74">[22]</a> provided by the <tt class="docutils literal">XGO</tt>,  you realize that it mostly consists of
the C/C++ libraries and C/C++ tools which are required for cross-platform
compilation and linking of C/C++ programs.  This small extract from the
corresponding <tt class="docutils literal"><span class="pre">Dockerfile``of</span> the ``XGO</tt> confirms my words.</p>
<div class="highlight"><pre>...

<span class="c"># Make sure apt-get is up to date and dependent packages are installed</span>
RUN <span class="se">\</span>
apt-get update <span class="o">&amp;&amp;</span> <span class="se">\</span>
apt-get install -y automake autogen build-essential ca-certificates            <span class="se">\</span>
gcc-5-arm-linux-gnueabi g++-5-arm-linux-gnueabi libc6-dev-armel-cross        <span class="se">\</span>
gcc-5-arm-linux-gnueabihf g++-5-arm-linux-gnueabihf libc6-dev-armhf-cross    <span class="se">\</span>
gcc-5-aarch64-linux-gnu g++-5-aarch64-linux-gnu libc6-dev-arm64-cross        <span class="se">\</span>
gcc-5-multilib g++-5-multilib gcc-mingw-w64 g++-mingw-w64 clang-3.7 llvm-dev <span class="se">\</span>
libtool libxml2-dev uuid-dev libssl-dev swig openjdk-7-jdk pkg-config patch  <span class="se">\</span>
make xz-utils cpio wget zip unzip p7zip git mercurial bzr texinfo help2man --no-install-recommends

<span class="c"># Fix any stock package issues</span>
RUN <span class="se">\</span>
ln -s /usr/include/asm-generic /usr/include/asm <span class="o">&amp;&amp;</span> <span class="se">\</span>
ln -s /usr/bin/clang-3.7 /usr/bin/clang         <span class="o">&amp;&amp;</span> <span class="se">\</span>
ln -s /usr/bin/clang++-3.7 /usr/bin/clang++

...
</pre></div>
<p>There is no evidence of the presence of the python runtime which the <tt class="docutils literal">cythonization</tt> depends on.  Perhaps I could fix this issue by adding python libraries to the
build toolchain of the <tt class="docutils literal">XGO</tt>. I would rather postpone the deciding this question until my next tutorial on the topic.</p>
<p>Is there any possibility to have a portable binary produced by the <tt class="docutils literal">Cython</tt>?</p>
<p>Yes. It is possible.</p>
<p>The next section is about the tool utilizing  the <tt class="docutils literal">Cython</tt>, <tt class="docutils literal">SWIG</tt>, <tt class="docutils literal">GCCGO</tt> and <tt class="docutils literal">my own packager</tt>. They  all together build
the portable cross-platform binary from the  python script.</p>
</div>
</div>
<div class="section" id="python-virtual-machine">
<h3><a class="toc-backref" href="#id96">Python Virtual Machine</a></h3>
<p>I have called this tool  &quot;Python Virtual Machine&quot;. Why is it &quot;Virtual Machine&quot;?
As you will see later, the result of the build chain is a package containing
the executable and its context which includes all needed dependencies like dynamic libraries and
python runtime environment.</p>
<p>The sketch of the toolchain is presented below.</p>
<pre class="doctest-block">
&gt;&gt;&gt;  Python (script.py) --&gt; Cython (script.c) --&gt; SWIG/GCCGO/GO --&gt; my own packager --&gt; a portable binary with the context
</pre>
<p>Let's clarify the unknown terms: <tt class="docutils literal">SWIG</tt> and <tt class="docutils literal">GCCGO</tt>.</p>
<p><a class="reference external" href="http://www.swig.org/">Simplified Wrapper and Interface Generator (SWIG)</a> <a class="footnote-reference" href="#id75" id="id76">[23]</a>
is a  tool that binds programs written in C and C++ with a variety of high-level programming languages.
Here we use the <tt class="docutils literal">SWIG</tt> to write out the <tt class="docutils literal">GO</tt>-specific interface of the <tt class="docutils literal">cythonized</tt> file <tt class="docutils literal">(script.c)</tt>.</p>
<p>Now it is time to tell about  the <tt class="docutils literal">GCCGO</tt> compiler.
The <tt class="docutils literal">GO</tt> language has always been defined by a spec, not an implementation. Hence
the <tt class="docutils literal">GO</tt> team has adopted two different compilers that implement that spec: <tt class="docutils literal">gcc</tt> and <tt class="docutils literal">GCCGO</tt>.</p>
<ul class="simple">
<li><tt class="docutils literal">gcc</tt> is the original compiler, and the <tt class="docutils literal">GO</tt> uses it by default.</li>
<li><tt class="docutils literal">GCCGO</tt> is a different implementation with a different focus</li>
</ul>
<p>Compared to the <tt class="docutils literal">gcc</tt>, the <tt class="docutils literal">GCCGO</tt>  slower to compile but supports more powerful optimization,
so a CPU-bound program built by <tt class="docutils literal">GCCGO</tt> will usually run faster.</p>
<p>The idea to use <tt class="docutils literal">GCCGO</tt> instead of the <tt class="docutils literal">CGO</tt> came to me after I read Yi Wang's  post <a class="reference external" href="https://cxwangyi.wordpress.com/2011/03/28/statically-linking-c-code-with-go-code/">Statically Link C++ Code With Go Code</a> <a class="footnote-reference" href="#id77" id="id78">[24]</a>.
I have slightly developed proposals of Yi Wang and added the <tt class="docutils literal">Cython</tt> generator for getting a <tt class="docutils literal">C/C++</tt> code from  a <tt class="docutils literal">Python</tt> script.
Then the obtained <tt class="docutils literal">C/C++</tt> file is processed by the <tt class="docutils literal">SWIG/GCCGO/GO</tt> tools in the way as Yi Wang suggests.</p>
<div class="important">
<p class="first admonition-title">Important</p>
<p class="last">To run next exercise, One must install the <tt class="docutils literal">SWIG</tt> generator. At the Ubuntu/Debian systems, it is usually done via <tt class="docutils literal">sudo <span class="pre">apt-get</span> install swig</tt>.</p>
</div>
<p>I have prepared the sub-project <tt class="docutils literal"><span class="pre">gccgo-python</span></tt> to demonstrate the technology on practice. One can simply change to the directory <tt class="docutils literal"><span class="pre">`gccgo-python</span></tt>
and build a binary through the <tt class="docutils literal">make</tt></p>
<div class="highlight"><pre><span class="nb">cd </span>gccgo-python
make
</pre></div>
<p>As a result, we obtain the  dinamically linked binary <tt class="docutils literal"><span class="pre">gccgo-python</span></tt> which wrapps around <tt class="docutils literal">src/simple_script.py</tt>.
The script makes simple computation with the help of <tt class="docutils literal">argparse</tt></p>
<!-- obtained with ``./rsTCodeBlockProducer.sh python gccgo-python/src/simple_script.py`` -->
<div class="highlight"><pre><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">https://docs.python.org/2.7/library/argparse.html</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">argparse</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">&#39;Process some integers.&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&#39;integers&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s">&#39;N&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s">&#39;+&#39;</span><span class="p">,</span>
                   <span class="n">help</span><span class="o">=</span><span class="s">&#39;an integer for the accumulator&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&#39;--sum&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&#39;accumulate&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&#39;store_const&#39;</span><span class="p">,</span>
                   <span class="n">const</span><span class="o">=</span><span class="nb">sum</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="nb">max</span><span class="p">,</span>
                   <span class="n">help</span><span class="o">=</span><span class="s">&#39;sum the integers (default: find the max)&#39;</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
 <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
 <span class="k">print</span> <span class="n">args</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">integers</span><span class="p">)</span>
</pre></div>
<p>If you list all dynamic libraries which executable loads, you will the presence of the <tt class="docutils literal">libpython2.7.so.1.0</tt>.</p>
<div class="highlight"><pre>ldd ./gccgo-python
ls -lh  ./gccgo-python
</pre></div>
<div class="highlight"><pre>linux-gate.so.1 <span class="o">=</span>&gt;  <span class="o">(</span>0xb7765000<span class="o">)</span>
libpython2.7.so.1.0 <span class="o">=</span>&gt; /usr/lib/libpython2.7.so.1.0 <span class="o">(</span>0xb747c000<span class="o">)</span>
libdl.so.2 <span class="o">=</span>&gt; /lib/i386-linux-gnu/i686/cmov/libdl.so.2 <span class="o">(</span>0xb7478000<span class="o">)</span>
libutil.so.1 <span class="o">=</span>&gt; /lib/i386-linux-gnu/i686/cmov/libutil.so.1 <span class="o">(</span>0xb7473000<span class="o">)</span>
libz.so.1 <span class="o">=</span>&gt; /lib/i386-linux-gnu/libz.so.1 <span class="o">(</span>0xb745a000<span class="o">)</span>
libgo.so.0 <span class="o">=</span>&gt; /usr/lib/i386-linux-gnu/libgo.so.0 <span class="o">(</span>0xb68d1000<span class="o">)</span>
libpthread.so.0 <span class="o">=</span>&gt; /lib/i386-linux-gnu/i686/cmov/libpthread.so.0 <span class="o">(</span>0xb68b8000<span class="o">)</span>
libm.so.6 <span class="o">=</span>&gt; /lib/i386-linux-gnu/i686/cmov/libm.so.6 <span class="o">(</span>0xb6892000<span class="o">)</span>
libgcc_s.so.1 <span class="o">=</span>&gt; /lib/i386-linux-gnu/libgcc_s.so.1 <span class="o">(</span>0xb6874000<span class="o">)</span>
libc.so.6 <span class="o">=</span>&gt; /lib/i386-linux-gnu/i686/cmov/libc.so.6 <span class="o">(</span>0xb6710000<span class="o">)</span>
/lib/ld-linux.so.2 <span class="o">(</span>0xb7766000<span class="o">)</span>

-rwxr-xr-x <span class="m">1</span> debian debian 49K May  <span class="m">2</span> 12:03 ./gccgo-python
</pre></div>
<p>This small binary can not be started at another machine. If you try to launch it somewhere else, you will probably get</p>
<pre class="doctest-block">
&gt;&gt;&gt; ./gccgo-python: error while loading shared libraries: libpython2.7.so.1.0: cannot open shared object file: No such file or directory
</pre>
<p>Now If we are repeating the same exercise with <tt class="docutils literal"><span class="pre">LDFLAGS=-static</span></tt>, the statically linked binary will be issued</p>
<div class="highlight"><pre><span class="nv">LDFLAGS</span><span class="o">=</span>-static make
ldd ./gccgo-python
ls -lh  ./gccgo-python
</pre></div>
<div class="highlight"><pre>...

not a dynamic executable

-rwxr-xr-x <span class="m">1</span> debian debian 4.5M May  <span class="m">2</span> 12:09 ./gccgo-python
</pre></div>
<p>There are pros and cons to this. On the positive side, we can run the executable across different platforms. The negative effect is
increase of file's size. However, when you try to execute this file at the machine without <tt class="docutils literal">python 2.7</tt> installed, you will come across the following
problem:</p>
<div class="highlight"><pre>ImportError: No module named site
</pre></div>
<p>This means that the python subroutines can't find modules needed to be imported. Can we fix it? Yes, we can. I have developed two hackish packagers
<tt class="docutils literal">build_package.sh</tt> and <tt class="docutils literal">build_package_simplified.sh</tt>. The latter is just a 'cutted' version  of the former. The shell scripts attempt to create an
archive with the python runtime environment and executable packed together.</p>
<div class="highlight"><pre>cat build_package.sh
</pre></div>
<div class="highlight"><pre><span class="c">#!/bin/bash</span>

mkdir -p package_<span class="nv">$1</span>/.libs
<span class="nb">echo</span> <span class="s2">&quot;dependences of the script... &quot;</span>
cp  <span class="nv">$1</span> package_<span class="nv">$1</span>/.libs
./statifier.py <span class="nv">$1</span>  package_<span class="nv">$1</span>/.libs

<span class="c"># common modules</span>
<span class="nb">echo</span> <span class="s2">&quot;copying common modules...&quot;</span>
mkdir -p package_<span class="nv">$1</span>/.libs/lib/
cp -r /usr/lib/python2.7/  package_<span class="nv">$1</span>/.libs/lib/

<span class="c"># scientific python modules and other stuff</span>
<span class="nb">echo</span> <span class="s2">&quot;copying scientific python modules and other stuff...&quot;</span>
mkdir -p package_<span class="nv">$1</span>/.libs/local/lib/
cp -r /usr/local/lib/python2.7/  package_<span class="nv">$1</span>/.libs/local/lib/

<span class="c"># numpy hack!</span>
<span class="c"># add numerical support for numpy!</span>
<span class="nb">echo</span> <span class="s2">&quot;adding numerical support for numpy!...&quot;</span>
cp /usr/lib/libblas.so.3 package_<span class="nv">$1</span>/.libs/
./statifier.py /usr/lib/libblas.so.3 package_<span class="nv">$1</span>/.libs/
cp /usr/lib/liblapack.so.3  package_<span class="nv">$1</span>/.libs/

<span class="c"># a hack to add hashlib support</span>
<span class="nb">echo</span> <span class="s2">&quot;hacking to add hashlib support...&quot;</span>
ls /usr/lib/python2.7/lib-dynload/  <span class="p">|</span> xargs -I <span class="o">{}</span> ./statifier.py /usr/lib/python2.7/lib-dynload/<span class="o">{}</span> package_<span class="nv">$1</span>/.libs/

<span class="c"># a hack to add matlab support</span>
<span class="nb">echo</span> <span class="s2">&quot;hacking to add matplotlib support...&quot;</span>
ls /usr/lib/python2.7/dist-packages/gi/  <span class="p">|</span> grep .so <span class="p">|</span> xargs -I <span class="o">{}</span> ./statifier.py /usr/lib/python2.7/dist-packages/gi/<span class="o">{}</span> package_<span class="nv">$1</span>/.libs/
<span class="c">#cp -r /usr/share/pyshared/gi/   /usr/lib/python2.7/dist-packages/</span>
rsync /usr/share/pyshared/gi package_<span class="nv">$1</span>/.libs/lib/python2.7/dist-packages/  -a --copy-links -v
rsync /usr/share/pyshared/wx-2.8-gtk2-unicode/wx package_<span class="nv">$1</span>/.libs/lib/python2.7/dist-packages/wx-2.8-gtk2-unicode/  -a --copy-links -v
rsync /usr/share/pyshared/wx-2.8-gtk2-unicode/wxPython package_<span class="nv">$1</span>/.libs/lib/python2.7/dist-packages/wx-2.8-gtk2-unicode/  -a --copy-links -v

<span class="nb">echo</span> <span class="s2">&quot;hacking Tornado Service of the WebAgg...&quot;</span>
sed -i <span class="s2">&quot;706s/\(.*\)/#\1/&quot;</span>   package_<span class="nv">$1</span>/.libs/local/lib/python2.7/dist-packages/tornado/ioloop.py
sed -i <span class="s2">&quot;707s/\(.*\)/#\1/&quot;</span>   package_<span class="nv">$1</span>/.libs/local/lib/python2.7/dist-packages/tornado/ioloop.py



<span class="nb">echo</span> <span class="s2">&quot;writting the executable script...&quot;</span>
cat  &gt; package_<span class="nv">$1</span>/<span class="nv">$1</span> <span class="s">&lt;&lt;_EOF</span>
<span class="s">#!/bin/bash</span>

<span class="s">_abs_path_to_this_file=\$(readlink -f &quot;\$0&quot;)</span>
<span class="s">_local_dir=\$(dirname &quot;\$_abs_path_to_this_file&quot;)</span>
<span class="s">_libs_dir=&quot;\${_local_dir}/.libs&quot;</span>

<span class="s">export LD_LIBRARY_PATH=\${_libs_dir}:\$LD_LIBRARY_PATH</span>
<span class="s">export PYTHONPATH=\${_libs_dir}/lib/python2.7/dist-packages/:\${_libs_dir}/lib/python2.7/:\${_libs_dir}/local/lib/python2.7/dist-packages/:\${_libs_dir}/local/lib/python2.7/:\$PYTHONPATH</span>
<span class="s">export PYTHONHOME=\${_libs_dir}</span>

<span class="s">.libs/$1 \$@</span>

<span class="s">_EOF</span>
chmod a+x package_<span class="nv">$1</span>/<span class="nv">$1</span>

<span class="c"># copy train.csv</span>
cp train.csv package_<span class="nv">$1</span>
<span class="nb">echo</span> <span class="s2">&quot;archiving...&quot;</span>
tar -zcf package_<span class="nv">$1</span>.tgz package_<span class="nv">$1</span>
</pre></div>
<p>Here is one more remark: to have a really portable binary, the python script should follow a few rules:</p>
<ul class="simple">
<li>a workaround, to escape native python modules on the target machine, should be implemented before imports of system-specific modules like <tt class="docutils literal">sklearn</tt>, <tt class="docutils literal">pandas</tt>, <tt class="docutils literal">matplotlib</tt> etc;</li>
<li>the <tt class="docutils literal">matplotlib</tt> should use <tt class="docutils literal">WebAgg</tt> engine to render graphics. The standard matplotblib's  backend <tt class="docutils literal">GTK</tt> is not portable across OS.</li>
</ul>
<p>The version of the well known script <tt class="docutils literal">titanic_logistic_regression_grid_search_roc_plot_example.py</tt>, where the above points are taken into account, can be found
in the directory <tt class="docutils literal"><span class="pre">gccgo-python/src</span></tt>.</p>
<div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="sd">&#39;&#39;&#39; This is an example of the application of the Logistic fucntion to the dataset analysis.</span>
<span class="sd">    Logistic function is helpful to model binary models</span>

<span class="sd">    This is a analysis with dedicated sklearn sub-modules.</span>

<span class="sd">    The basic idea is taken from</span>
<span class="sd">    http://scikit-learn.org/stable/auto_examples/linear_model/plot_iris_logistic.html#example-linear-model-plot-iris-logistic-py</span>
<span class="sd">    http://scikit-learn.org/stable/auto_examples/grid_search_digits.html</span>
<span class="sd">    http://www.pyimagesearch.com/2014/06/23/applying-deep-learning-rbm-mnist-using-python/</span>

<span class="sd">    DataFrameImputer was taken from</span>
<span class="sd">    http://stackoverflow.com/questions/25239958/impute-categorical-missing-values-in-scikit-learn</span>

<span class="sd">    About Precision and Recall</span>
<span class="sd">    http://en.wikipedia.org/wiki/Precision_and_recall</span>

<span class="sd">    About Type 1 and Type 2 errors</span>
<span class="sd">    http://en.wikipedia.org/wiki/Type_I_and_type_II_errors</span>

<span class="sd">    About scorring parameters for sklearn classifiers</span>
<span class="sd">    http://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter</span>

<span class="sd">    About plottig ROC in sklearn</span>
<span class="sd">    http://scikit-learn.org/stable/auto_examples/plot_roc_crossval.html</span>

<span class="sd">    About plottig Precision vs Recall in sklearn</span>
<span class="sd">    http://scikit-learn.org/stable/auto_examples/plot_precision_recall.html</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pprint</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;/usr/local/lib/python2.7/dist-packages&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span> <span class="c"># to fix the problem with numpy: this replaces  1.6 version by 1.9</span>

<span class="c"># workaround to escape native python modules on the target machine</span>
<span class="k">try</span><span class="p">:</span>
  <span class="n">pythonpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;PYTHONPATH&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pythonpath</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">)):</span>
   <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">item</span><span class="p">)</span>
<span class="k">except</span>  <span class="ne">KeyError</span><span class="p">,</span><span class="n">e</span><span class="p">:</span>
  <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">ExtraTreesClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">Imputer</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">TransformerMixin</span>
<span class="kn">from</span> <span class="nn">StringIO</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">import</span> <span class="nn">prettytable</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="kn">as</span> <span class="nn">sm</span>
<span class="c">#  Gtk and Wx are not cross-platformed. Use WebAgg for matplotlib backend!</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s">&#39;WebAgg&#39;</span><span class="p">)</span>

<span class="o">...</span>
</pre></div>
<p>To make the portable binary package of the Machine-Learning script, you execute several commands as shown below.</p>
<div class="highlight"><pre><span class="nb">cd </span>gccgo-python/
make clean
<span class="nv">PYSRC</span><span class="o">=</span>src/titanic_logistic_regression_grid_search_roc_plot_example.py make
make build-package
ls -lh package_gccgo-python.tgz
</pre></div>
<p>You will see the output of the previous command if everything runs smoothly.</p>
<div class="highlight"><pre> ...
 hacking Tornado Service of the WebAgg...
 writting the executable script...
 archiving...

-rw-r--r-- <span class="m">1</span> debian debian 358M May  <span class="m">2</span> 13:00 package_gccgo-python.tgz
</pre></div>
</div>
<div class="section" id="static-python">
<h3><a class="toc-backref" href="#id97">Static-Python</a></h3>
<p>This is <a class="reference external" href="https://github.com/bendmorris/static-python">a fork</a> <a class="footnote-reference" href="#id79" id="id80">[25]</a> of the official Python hg repository with additional tools to enable building Python for static linking.</p>
<p>Using the <tt class="docutils literal"><span class="pre">Static-Python</span></tt>, we can</p>
<ul class="simple">
<li>run Python programs on other machines without requiring that they install Python.</li>
<li>run Python programs on other machines without requiring that they have the same versions of the same libraries installed that you do.</li>
</ul>
<p>Unfortunately I have to remark that <tt class="docutils literal"><span class="pre">Static-Python</span></tt> doesn't support <tt class="docutils literal">python scientific</tt> extensions and modules like <tt class="docutils literal">numpy</tt>, <tt class="docutils literal">pandas</tt> etc.
Only 'simple' modules (pure pythonic) could be invoked in the statically linked python environment. The simple <tt class="docutils literal"><span class="pre">HOW-TO</span></tt> on usage of the package is presented
below.</p>
<div class="highlight"><pre>git clone https://github.com/bendmorris/static-python
<span class="nb">cd </span>static-python
git checkout 2.7
sudo apt-get install  python-gdbm
sudo apt-get install python-tk
<span class="c"># change add-ons to the BUILTINS variable in Static.make They should be defined as give below</span>
<span class="c"># override BUILTINS+= array cmath math _struct time  _random operator _collections _heapq itertools _functools _elementtree   _bisect unicodedata atexit _weakref datetime</span>
nano Static.make
make -f Static.make <span class="nv">BUILTINS</span><span class="o">=</span><span class="s2">&quot;math&quot;</span>
ldd ./python
</pre></div>
<pre class="doctest-block">
&gt;&gt;&gt;  not a dynamic executable
</pre>
<p>We can test the <tt class="docutils literal">math</tt> module, if execute the following command.</p>
<div class="highlight"><pre>./python  -c <span class="s2">&quot;import math; print math.pi&quot;</span>
</pre></div>
<pre class="doctest-block">
&gt;&gt;&gt;  3.14159265359
</pre>
</div>
<div class="section" id="bonus-a-simple-statifier-to-make-a-portable-executable-package-from-any-binary">
<h3><a class="toc-backref" href="#id98">Bonus: A simple statifier to make a portable executable package from any binary</a></h3>
<p>There are several statifiers on the marker:</p>
<ul class="simple">
<li><a class="reference external" href="https://sourceforge.net/projects/statifier/">ELF statifier</a> <a class="footnote-reference" href="#id81" id="id82">[26]</a></li>
<li><a class="reference external" href="http://magicermine.com/">Ermine</a> <a class="footnote-reference" href="#id83" id="id84">[27]</a></li>
</ul>
<p>None of them suits well if need a free of charge, out-of-box solution.</p>
<p><tt class="docutils literal">ELF statifiers</tt> requires to switch off the address randomization in the kernel,</p>
<div class="highlight"><pre>cat /proc/sys/kernel/randomize_va_space
<span class="nb">echo</span> -n <span class="m">0</span> &gt; /proc/sys/kernel/randomize_va_space
statify xxxxx yyyyyy
<span class="nb">echo</span> -n <span class="m">2</span> &gt; /proc/sys/kernel/randomize_va_space
</pre></div>
<p>while <tt class="docutils literal">Ermine</tt> costs money.</p>
<p>I have written a simple shell script to pack any executable together with the runtime environment.
It is called <tt class="docutils literal">binary_statifier</tt>. You might probe it via the executing a set of commands as shown below.</p>
<div class="highlight"><pre><span class="c"># let&#39;s build a portable package for the  LateX system</span>
cp <span class="sb">`</span>which latex<span class="sb">`</span> .
./build_package.sh latex
rm latex
</pre></div>
<p>Then we can extract the package at other machine and run it.</p>
<div class="highlight"><pre><span class="c"># another platform</span>
tar -xf package_latex.tgz
<span class="nb">cd </span>package_latex
./latex
</pre></div>
<p>The output of the last command might be like below.</p>
<div class="highlight"><pre>warning: kpathsea: configuration file texmf.cnf not found in these directories: /etc/texmf/web2c:/usr/share/texlive/texmf/web2c:/usr/share/texlive/texmf-dist/web2c:/usr/local/share/texmf/web2c.
This is pdfTeX, Version 3.1415926-2.4-1.40.13 <span class="o">(</span>TeX Live 2012/Debian<span class="o">)</span>
**
! End of file on the terminal... why?
</pre></div>
</div>
<div class="section" id="documentation">
<h3><a class="toc-backref" href="#id99">Documentation</a></h3>
<p>The main parts of documentation are placed  in the <tt class="docutils literal">README.rst</tt>.
Running the command</p>
<div class="highlight"><pre>make doc
</pre></div>
<p>will make a folder <tt class="docutils literal">doc/</tt> with the <tt class="docutils literal">index.html</tt> which presents documention  in
the HTML format. One can start httpd service to see the documention at the <tt class="docutils literal">localhost:8010</tt>.</p>
<div class="highlight"><pre>make serve
</pre></div>
</div>
<div class="section" id="references">
<h3><a class="toc-backref" href="#id100">References</a></h3>
<table class="docutils footnote" frame="void" id="id30" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id31">[1]</a></td><td><a class="reference external" href="https://bitbucket.org/iggy_floyd/virtual_machine_python">https://bitbucket.org/iggy_floyd/virtual_machine_python</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id32" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id33">[2]</a></td><td><a class="reference external" href="http://bits.citrusbyte.com/protecting-a-python-codebase/">http://bits.citrusbyte.com/protecting-a-python-codebase/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id34" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id35">[3]</a></td><td><a class="reference external" href="https://github.com/citrusbyte/python-obfuscation">https://github.com/citrusbyte/python-obfuscation</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id36" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id37">[4]</a></td><td><a class="reference external" href="http://stackoverflow.com/questions/261638/how-do-i-protect-python-code">http://stackoverflow.com/questions/261638/how-do-i-protect-python-code</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id38" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[5]</td><td><em>(<a class="fn-backref" href="#id39">1</a>, <a class="fn-backref" href="#id54">2</a>)</em> <a class="reference external" href="https://mborgerson.com/creating-an-executable-from-a-python-script">https://mborgerson.com/creating-an-executable-from-a-python-script</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id40" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id41">[6]</a></td><td><a class="reference external" href="http://nuitka.net/doc/user-manual.html#command-line">http://nuitka.net/doc/user-manual.html#command-line</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id42" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id43">[7]</a></td><td><a class="reference external" href="https://pypi.python.org/pypi/Cython/">https://pypi.python.org/pypi/Cython/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id44" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id45">[8]</a></td><td><a class="reference external" href="https://bitbucket.org/iggy_floyd/go-cpp">https://bitbucket.org/iggy_floyd/go-cpp</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id46" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id47">[9]</a></td><td><a class="reference external" href="https://bitbucket.org/iggy_floyd/go-tutorial">https://bitbucket.org/iggy_floyd/go-tutorial</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id48" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id49">[10]</a></td><td><a class="reference external" href="https://bitbucket.org/iggy_floyd/test-otto">https://bitbucket.org/iggy_floyd/test-otto</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id50" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id51">[11]</a></td><td><a class="reference external" href="https://golang.org/doc/install">https://golang.org/doc/install</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id52" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id53">[12]</a></td><td><a class="reference external" href="https://github.com/robertkrimen/godocdown">https://github.com/robertkrimen/godocdown</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id55" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id56">[13]</a></td><td><a class="reference external" href="http://www.wxpython.org/">http://www.wxpython.org/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id57" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id58">[14]</a></td><td><a class="reference external" href="http://stackoverflow.com/questions/35020183/pyinstaller-not-compiling-large-program-in-python2-7-64-bit-ubuntu">http://stackoverflow.com/questions/35020183/pyinstaller-not-compiling-large-program-in-python2-7-64-bit-ubuntu</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id59" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id60">[15]</a></td><td><a class="reference external" href="http://stackoverflow.com/questions/2716702/no-such-file-or-directory-error-when-executing-a-binary">http://stackoverflow.com/questions/2716702/no-such-file-or-directory-error-when-executing-a-binary</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id61" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id62">[16]</a></td><td><a class="reference external" href="https://github.com/cython/cython/wiki/EmbeddingCython">https://github.com/cython/cython/wiki/EmbeddingCython</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id63" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id64">[17]</a></td><td><a class="reference external" href="http://scikit-learn.org/stable/">http://scikit-learn.org/stable/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id65" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id66">[18]</a></td><td><a class="reference external" href="https://www.kaggle.com/c/titanic">https://www.kaggle.com/c/titanic</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id67" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id68">[19]</a></td><td><a class="reference external" href="https://github.com/golang/go/wiki/WindowsCrossCompiling">https://github.com/golang/go/wiki/WindowsCrossCompiling</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id69" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id70">[20]</a></td><td><a class="reference external" href="https://github.com/karalabe/xgo">https://github.com/karalabe/xgo</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id71" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id72">[21]</a></td><td><a class="reference external" href="https://bitbucket.org/iggy_floyd/xgo-cpp/">https://bitbucket.org/iggy_floyd/xgo-cpp/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id73" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id74">[22]</a></td><td><a class="reference external" href="https://raw.githubusercontent.com/karalabe/xgo/master/docker/base/Dockerfile">https://raw.githubusercontent.com/karalabe/xgo/master/docker/base/Dockerfile</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id75" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id76">[23]</a></td><td><a class="reference external" href="http://www.swig.org/">http://www.swig.org/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id77" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id78">[24]</a></td><td><a class="reference external" href="https://cxwangyi.wordpress.com/2011/03/28/statically-linking-c-code-with-go-code/">https://cxwangyi.wordpress.com/2011/03/28/statically-linking-c-code-with-go-code/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id79" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id80">[25]</a></td><td><a class="reference external" href="https://github.com/bendmorris/static-python">https://github.com/bendmorris/static-python</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id81" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id82">[26]</a></td><td><a class="reference external" href="https://sourceforge.net/projects/statifier/">https://sourceforge.net/projects/statifier/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id83" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id84">[27]</a></td><td><a class="reference external" href="http://magicermine.com/">http://magicermine.com/</a></td></tr>
</tbody>
</table>
</div>
</div>

            </div>
            <!-- /.entry-content -->
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    </div>
    <!-- AddThis Button END -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'igormarfingithubio'; // required: replace example with your forum shortname

                    var disqus_identifier = 'statifiers-for-python-and-c++.-statifiering-python-machine-learning-scripts';
                var disqus_url = 'http://igormarfin.github.io/blog/2016/05/02/statifiers-for-python-and-c++.-statifiering-python-machine-learning-scripts/';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy;  Dr. Igor Marfin
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>              <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://igormarfin.github.io/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://igormarfin.github.io/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://igormarfin.github.io/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'igormarfingithubio'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->

        <script type="text/javascript">var addthis_config = {"data_track_addressbar": true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-571208988724f2bf"></script>
  <script type="text/javascript">
    var disqus_shortname = 'igormarfingithubio';
    var disqus_identifier = '/blog/2016/05/02/statifiers-for-python-and-c++.-statifiering-python-machine-learning-scripts/';
    var disqus_url = 'http://igormarfin.github.io/blog/2016/05/02/statifiers-for-python-and-c++.-statifiering-python-machine-learning-scripts/';
    var disqus_title = 'Statifiers for Python and C++. Statifiering python Machine-Learning scripts';
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = "//" + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
  </script>
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>
</body>
</html>